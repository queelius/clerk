version: "3.8"

services:
  greenmail:
    image: greenmail/standalone:2.0.1
    container_name: clerk-demo-mail
    ports:
      - "3025:3025"   # SMTP
      - "3143:3143"   # IMAP
    environment:
      - GREENMAIL_OPTS=-Dgreenmail.setup.test.all -Dgreenmail.verbose -Dgreenmail.hostname=0.0.0.0 -Dgreenmail.users=demo:demo@example.com,alice:alice@example.com,bob:bob@example.com
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "3143"]
      interval: 5s
      timeout: 3s
      retries: 5
